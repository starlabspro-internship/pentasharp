@{
    ViewData["Title"] = "Incoming Taxi Bookings";
}

<div class="container my-5">
    <h1 class="text-center mb-4 fw-bold text-primary">Incoming Taxi Bookings</h1>

    <div class="list-group" id="bookingList">
        <div class="list-group-item d-flex align-items-center justify-content-between shadow-sm p-3 mb-2 rounded" data-booking-id="1">
            <div>
                <h6 class="mb-1 fw-bold">Jane Smith</h6>
                <small class="text-muted">Pickup: Central Park</small><br>
                <small class="text-muted">Dropoff: Times Square</small><br>
                <small class="text-muted">Pickup Time: 10:00 AM | Seats: 2</small><br>
                <small class="text-warning fw-bold" id="status-1">Status: Pending</small>
            </div>
            <button id="confirmButton-1" class="btn btn-outline-success btn-sm" onclick="openConfirmModal('Jane Smith', 'Central Park', 'Times Square', '10:00 AM', '1')">
                Confirm
            </button>
        </div>

        <div class="list-group-item d-flex align-items-center justify-content-between shadow-sm p-3 mb-2 rounded" data-booking-id="2">
            <div>
                <h6 class="mb-1 fw-bold">Michael Johnson</h6>
                <small class="text-muted">Pickup: Wall Street</small><br>
                <small class="text-muted">Dropoff: Empire State Building</small><br>
                <small class="text-muted">Pickup Time: 11:30 AM | Seats: 1</small><br>
                <small class="text-warning fw-bold" id="status-2">Status: Pending</small>
            </div>
            <button id="confirmButton-2" class="btn btn-outline-success btn-sm" onclick="openConfirmModal('Michael Johnson', 'Wall Street', 'Empire State Building', '11:30 AM', '2')">
                Confirm
            </button>
        </div>
    </div>
</div>

<div class="modal fade" id="confirmBookingModal" tabindex="-1" aria-labelledby="confirmBookingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title fw-bold" id="confirmBookingModalLabel">Assign Driver</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p><strong>Passenger:</strong> <span id="modalPassengerName"></span></p>
                <p><strong>Pickup:</strong> <span id="modalPickupLocation"></span></p>
                <p><strong>Dropoff:</strong> <span id="modalDropoffLocation"></span></p>
                <p><strong>Pickup Time:</strong> <span id="modalPickupTime"></span></p>
                <p class="text-danger">* The first driver to confirm will be assigned.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-sm" onclick="confirmBooking()">Confirm Booking</button>
            </div>
        </div>
    </div>
</div>

<script>
    let selectedBookingId = null;
    const currentDriver = "John Doe"; // Replace with the current driver's name

    function openConfirmModal(passengerName, pickupLocation, dropoffLocation, pickupTime, bookingId) {
        selectedBookingId = bookingId;
        document.getElementById('modalPassengerName').textContent = passengerName;
        document.getElementById('modalPickupLocation').textContent = pickupLocation;
        document.getElementById('modalDropoffLocation').textContent = dropoffLocation;
        document.getElementById('modalPickupTime').textContent = pickupTime;
        new bootstrap.Modal(document.getElementById('confirmBookingModal')).show();
    }

    function confirmBooking() {
        const statusElement = document.getElementById(`status-${selectedBookingId}`);
        const confirmButton = document.getElementById(`confirmButton-${selectedBookingId}`);
        
        statusElement.textContent = `Assigned to: ${currentDriver}`;
        statusElement.classList.replace("text-warning", "text-success");
        
        confirmButton.style.display = 'none'; // Hide the Confirm button
        document.getElementById('confirmBookingModal').querySelector('.btn-close').click();
    }
</script>

<style>
    .list-group-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .btn-outline-success {
        color: #28a745;
        border-color: #28a745;
    }

    .btn-outline-success:hover {
        background-color: #28a745;
        color: #fff;
    }

    .modal-sm {
        max-width: 500px;
    }
</style>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
